graph TD

subgraph GitHub Actions
    A1[Workflow]
    A2[OIDC Token<br>(issued by GitHub)]
    A1 --> A2
end

subgraph AWS
    B1[OIDC Provider<br>token.actions.githubusercontent.com]
    B2[GithubActionsRole<br>(IAM Role)]
    B3[Trust Policy<br>sub = repo:alan.kowalzky/rs-devops-course-tasks:*]
    B4[Attached Policies:<br>S3, EC2, IAM, etc.]
    B5[S3 Buckets<br>application-data / tfstate]

    B1 --> B2
    B3 --> B2
    B4 --> B2
    B2 --> B5
end

A2 -->|AssumeRoleWithWebIdentity| B2
B2 -->|Temporary Credentials| A1
